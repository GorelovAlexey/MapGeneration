# Генератор ландшафта
Набор скриптов для генерации ландшафта в редакторе. 
### Фичи
Реализованы следующие фичи:
- Генерация шума Перлина
- Создание текстуры из данного шума
- Симуляция водной эрозии (2 вида)
- Построение 3д модели полученного ландшафта (3 вида)
### Пример работы скрипта
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/a16a7fed-a724-40b0-a369-d4429e1a4921) </br>
*Сгенерированный случайный шум* </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/02ee46d4-b956-44e3-a5c6-be056bd952a3) </br>
*После симуляции эрозии* </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/c372210f-a061-4607-936e-be722203454c) </br>
*3Д модели* </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/a9493413-1429-43b6-a97d-3b776be99340) </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/496f36ac-7c78-4a47-8cd3-74e33194f6fe) </br>
*Дебаг режим, фильтр отложения пород. Синий - размытие породы эрозией, красный - отложение породы эрозией* </br>
### Использование
2 скрипта работают в редакторе Unity. Первый вспомогательный скрипт отвечает за генерацию меша (выделен в отдельный скрипт чтобы облегчить основной) </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/226ea06d-34f2-4150-b8f9-0ef39fe0001d) </br>
Основной скрипт отвечающий за генерацию, работает в редакторе. Редактор переписан в классе SpriteGeneratorEditor  </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/9a14dfb3-d5cb-47de-b24f-5aac9766e11e)  </br>
1. NoiseSettings - настройки генератора шума перлина
2. ColorSettings - настройки раскрашивания текстуры
   - Принцип работы крайне прост, берется нормализированный двумерный массив float и все клетки раскрашиваются в зависимости от значения.
   - Одним массивом задаются цвета.
   - Другим массивом задаются уровни, все значения между этими уровнями раскрашиваются в этот цвет
   - Цвета дополнительно осветляются, тем сильней чем значение ближе к верхней границе уровня. 
3. Переключение между двумя алгортимами эрозии ErosionSimple и ErosionBetter.
4. Управляющие кнопки - генерация шума, запуск алгоритма эрозии, 3 кнопки генерации мешей.
5. Кнопка дебага - показ различных фильтров для отладки работы алгоритма.
### Алгоритм эрозии
Реализованы 2 алгоритма водной эрозии переключаются кнопками ErosionSimple и ErosionBetter.
1. ErosionSimple
  - Первая попытка, без прибегания к работам других людей. К сожалению, не генерирует характерные для гор формы. Алгоритм выравнивает почву между склонами и выравнивает плато, склоны холмов получают небольшие неровности.
2. ErosionBetter
  - Реализация алгоритма по научной работе "Implementation of a method for hydraulic erosion Hans Theobald Beyer" ссылка: https://www.firespark.de/resources/downloads/implementation%20of%20a%20methode%20for%20hydraulic%20erosion.pdf
  - В документе не содержится кода, алгоритм написан по описанию работы алгоритма и формулам приведенным в работе.
  - Генерирует характерные крутые склоны у гор и участки плато между горами.
### Генерация мешей 
Для визуализации работа алгоритма имеется метод для генерации мешей. В зависимости от выбранного типа меша он разбивается на несколько кусков определенного размера. 
1. Simple. Первый вариант, без нормальных нормалей, но в целом позволяет оценить форму.
2. Better. Улучшенный вариант, по виду напоминает ланшафт из Minecraft. Отличается от предыдущего нормальными тенями
3. Smooth. "Гладкий" меш, 1 ячейка исходного массива = 1 вершина меша.
Для текстуры используется изначально сгенерированный спрайт. Боковые грани разбиваются так чтобы граница уровней была на 1 уровне. </br>
![image](https://github.com/GorelovAlexey/MapGeneration/assets/33570758/68094005-5141-4eb4-ba51-628bad2bfd99)


